<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Skye Pi | Profile</title>
  <link rel="stylesheet" href="style-1.css" />
<style>
   .bg-color{
  background-color: rgb(255, 255, 255);
}
.z{
  z-index: 1;
  color: #0d6efd;
}
.padding1{
  padding: 5px;
}
.border-r{
  border-radius: 5%;
}
.pad1{
    background-color: white;
    scroll-behavior:smooth;
    border-radius: 10%;
    overflow-y: hidden;
    max-height: 20%;
}
.pad3{
  scroll-behavior:smooth;
  border-radius: 10%;
  overflow-x:hidden;
  max-height:20%;
}
.pad2{
  padding: 20px;
  overflow: auto;
  text-align: justify;
  color:black;
}
.inline {
  display:inline-flex;
  align-items: center;
  text-align: start;
}
.bookmark{
  width: fit-content;
  height: auto;
  max-width: 25px;
  min-width: auto;
  max-height: fit-content;
  min-height: auto;
  margin: 5px;
}

.background{
    background-color: whitesmoke;
}
.marginr{
  margin: 0px 5px 0px 0px;
}.marginl{
  margin: 0px 0px 0px 5px;
}
.shadow{
    filter:drop-shadow(8px 8px rgb(73, 73, 73));
}
a:link {
    text-decoration: none;
}
.pad3{

}
.font2{
  font-family: 'Gill Sans', 'Gill Sans MT', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif, 'Trebuchet MS', sans-serif;
  font-style: normal;
  font-size: 35px;
  text-decoration: none;
  text-align: center;
  align-content: center;
    vertical-align: middle;
}
.font{
  font-family: 'Gill Sans', 'Gill Sans MT', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif, 'Trebuchet MS', sans-serif;
  font-style: normal;
    font-size: 30px;
    text-decoration: none;
    text-align: center;
    align-content: center;
    vertical-align: middle;
}
.width1{
  width:50%;
}

.height1{
  width:50%;
}
.margin1{
  margin:15px auto 15px auto;
}
.margin2{
  margin:0px auto 0px auto;
}
.marginAuto{
  margin: 25% auto 0% 0%;
}
.margin3{
  margin:5px auto 5px auto;
}
.width5{
  height:25%;
}
.height5{
  height:25%;
}
.width10{
  width:75%;
}

.height2{
  width:100%;
}
.width2{
  width:100%;
}
.widtha{
  width:auto;
}
@media screen and ((min-width:150px) and (max-width:850px)){
  .btn-widths{
    width:25%;
  }
  .padding1{
    padding: 10px;
  }
  .width1{
    width:50%;
}
  .width2{
    width:100%;
  }
  .width5{
    width:25%;
  }
  .width10{
    width:75%;
  }
  .height1{
  height:50%;
  }
  .height5{
  width:25%;
  }
  .font2{
    font-family: 'Gill Sans', 'Gill Sans MT', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif, 'Trebuchet MS', sans-serif;
    font-style: normal;
    font-size: 25px;
    text-decoration: none;
    text-align: center;
    align-content: center;
    vertical-align: middle;
  }

  .font{
    font-family: 'Gill Sans', 'Gill Sans MT', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif, 'Trebuchet MS', sans-serif;
    font-style: normal;
    font-size: 20px;
    text-decoration: none;
    text-align: center;
    align-content: center;
    vertical-align: middle;
  }
  .font3{
    font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
    font-style: normal;
    font-size: 12px;
    text-decoration: none;
  }

  .pad{
    background-color: white;
    padding: 5px;
    overflow-x: scroll;
  }
  .btn{
    width:100%;
    height:50px;
  }
  .p1{
  font-size: 16px;
  font-family: Monospace;
  font:18px;
  }
  .p{
    font:16px;
  }
  .sm-body{
    
    width:100%;
  }
  .sm-img{
    
    width:100%;
  }
  .sm-pad{
    width:100%;
  }
 
}
@media screen and (min-width:900px){
  .max-width{
  max-width: 50%;
}
}
/* Add your existing CSS styles here */

/* Simple Example */
.container {
  width: 50%;
  margin: auto;
  padding: 20px;
  border: 2px solid #ccc;
  border-radius: 10px;
  background-color: white;
}

input[type="email"], input[type="password"] {
  width: 100%;
  padding: 10px;
  margin: 10px 0;
  border-radius: 5px;
}

button {
  width: 100%;
  padding: 10px;
  background-color: #007bff;
  color: white;
  border: none;
  border-radius: 5px;
}

button:hover {
  background-color: #0056b3;
}

a {
  color: #007bff;
}

a:hover {
  text-decoration: underline;
}

</style>
</head>
<body>
  <main id="profileContent" class="text-center">
    <img id="profileImage" src="/images/default-profile.png" class="img-fluid rounded-circle mb-3" width="150" alt="Profile Image">
    <h1 id="preferredName" class="fw-bold">Loading...</h1>
    <p id="bio">Loading bio...</p>

    <div class="d-flex flex-wrap justify-content-center">
      <a href="/donate" class="btn btn-danger m-2">Donate</a>
      <a href="/wish-list" class="btn btn-secondary m-2">Wish List</a>
      <a href="/follow-the-story" class="btn btn-primary m-2">Follow the Story</a>
    </div>

    <section class="qr-code mt-4">
      <a id="qrLink" href="#">
        <img id="qrImage" src="/images/unknown.jpg" alt="QR Code" class="img-fluid shadow rounded">
      </a>
    </section>
  </main>

  <!-- Firebase Scripts -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAPbRitIvjFraGw7cu3VzoGDkEg-EbkRQY",
      authDomain: "skye-pi.firebaseapp.com",
      projectId: "skye-pi",
      storageBucket: "skye-pi.firebasestorage.app",
      messagingSenderId: "81096604979",
      appId: "1:81096604979:web:f0d89dacde2f978d775246",
      measurementId: "G-1S4973D84M"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    async function loadProfile() {
      const params = new URLSearchParams(window.location.search);
      const id = params.get('id');

      if (!id) {
        document.getElementById('preferredName').innerText = 'Profile Not Found';
        return;
      }

      const docRef = doc(db, 'profiles', id);
      const docSnap = await getDoc(docRef);

      if (docSnap.exists()) {
        const data = docSnap.data();

        document.getElementById('preferredName').innerText = data.preferredName || data.govName || 'Unnamed';
        document.getElementById('bio').innerText = data.bio || 'No bio available.';

        if (data.profileImageUrl) {
          document.getElementById('profileImage').src = data.profileImageUrl;
        }

        // Link to user's QR code page
        document.getElementById('qrLink').href = `/qr_code.html?id=${id}`;
        document.getElementById('qrImage').src = `/qr_preview_images/${id}.png`; // optional placeholder path
      } else {
        document.getElementById('preferredName').innerText = 'Profile Not Found';
      }
    }

    loadProfile();
  </script>
</body>
</html>
